empty:
  src: ""
  res: "SELECT objects.* FROM objects WHERE objects.parent_id = ID"

objects:
  res: "SELECT objects.* FROM objects WHERE objects.parent_id = ID"

objects_in_project:
  res: "SELECT objects.* FROM objects WHERE objects.project_id = PROJECT_ID"

recipients:
  res: "SELECT objects.* FROM objects,links WHERE objects.id = links.target_id AND links.relation_id = 4 AND links.source_id = ID"

letters_in_project:
  res: "SELECT objects.* FROM objects WHERE objects.kpath LIKE 'NNL%' AND objects.project_id = PROJECT_ID"

parent:
  res: "SELECT objects.* FROM objects WHERE objects.id = PARENT_ID"

order_single_table:
  src: "objects in project order by name ASC"
  res: "SELECT objects.* FROM objects WHERE objects.project_id = PROJECT_ID ORDER BY objects.name ASC"

order_many_tables:
  src: "recipients order by name ASC"
  res: "SELECT objects.* FROM objects,links WHERE objects.id = links.target_id AND links.relation_id = 4 AND links.source_id = ID ORDER BY objects.name ASC"

order_many_params:
  src: "objects in project order by name ASC, id DESC"
  res: "SELECT objects.* FROM objects WHERE objects.project_id = PROJECT_ID ORDER BY objects.name ASC, objects.id DESC"

limit:
  src: "objects in project limit 2"
  res: "SELECT objects.* FROM objects WHERE objects.project_id = PROJECT_ID LIMIT 2"
  
offset_in_limit:
  src: "objects in project limit 3,2"
  res: "SELECT objects.* FROM objects WHERE objects.project_id = PROJECT_ID LIMIT 2 OFFSET 3"

offset:
  src: "objects in project limit 2 offset 3"
  res: "SELECT objects.* FROM objects WHERE objects.project_id = PROJECT_ID LIMIT 2 OFFSET 3"

paginate:
  src: "objects in site limit 2 paginate p"
  res: "SELECT objects.* FROM objects LIMIT 2 OFFSET #{((p.to_i > 0 ? p.to_i : 1)-1)*2}"

recipients_or_objects:
  src:
    - "recipients"
    - "objects"
  res: "SELECT objects.* FROM objects,links WHERE ((objects.id = links.target_id AND links.relation_id = 4 AND links.source_id = ID) OR (objects.parent_id = ID)) GROUP BY objects.id"

recipients_or_objects_order_query1:
  src:
    - "recipients order by query1"
    - "objects"
  res: "SELECT objects.*,(objects.id = links.target_id AND links.relation_id = 4 AND links.source_id = ID) AS query1 FROM objects,links WHERE ((objects.id = links.target_id AND links.relation_id = 4 AND links.source_id = ID) OR (objects.parent_id = ID)) GROUP BY objects.id ORDER BY query1 ASC"

custom_query:
  context:
    custom_query_group: test
  src: "abc"
  res: "SELECT a,34 AS number,c FROM test WHERE 3 AND 2 AND 1 ORDER BY a"

count_sql:
  src: "objects in project"
  count: "SELECT COUNT(*) FROM objects WHERE objects.project_id = PROJECT_ID"